<UserControl
    x:Class="NINA.View.FramingAssistantView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:behaviors="clr-namespace:NINA.Utility.Behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    xmlns:local="clr-namespace:NINA.View"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ninactrl="clr-namespace:NINACustomControlLibrary;assembly=NINACustomControlLibrary"
    xmlns:ns="clr-namespace:NINA.Locale"
    xmlns:rules="clr-namespace:NINA.Utility.ValidationRules"
    d:DesignHeight="300"
    d:DesignWidth="300"
    mc:Ignorable="d">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="5" />
            <ColumnDefinition Width="8*" />
        </Grid.ColumnDefinitions>
        <StackPanel Orientation="Vertical">

            <GroupBox Header="{ns:Loc LblCoordinates}">
                <StackPanel Orientation="Vertical">
                    <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                        <UniformGrid
                            Margin="0,6,0,6"
                            VerticalAlignment="Center"
                            Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblRA}" />
                            <StackPanel Orientation="Horizontal">
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="RAHours" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:HoursRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">h</TextBlock>
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="RAMinutes" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:MinutesRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">m</TextBlock>
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="RASeconds" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:SecondsRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">s</TextBlock>
                            </StackPanel>

                        </UniformGrid>

                    </Border>
                    <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                        <UniformGrid
                            Margin="0,6,0,6"
                            VerticalAlignment="Center"
                            Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblDec}" />
                            <StackPanel Orientation="Horizontal">
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="DecDegrees" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:DegreesRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">d</TextBlock>
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="DecMinutes" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:MinutesRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">m</TextBlock>
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="DecSeconds" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:SecondsRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">s</TextBlock>
                            </StackPanel>

                        </UniformGrid>
                    </Border>
                    <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                        <UniformGrid Margin="0,6,0,6" Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblFieldOfView}" />
                            <StackPanel Orientation="Horizontal">
                                <TextBox
                                    MinWidth="40"
                                    Margin="5,0,0,0"
                                    Text="{Binding FieldOfView}" />
                                <TextBlock
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblDegree}" />
                            </StackPanel>

                        </UniformGrid>
                    </Border>
                </StackPanel>
            </GroupBox>

            <UniformGrid Columns="2">
                <ninactrl:CancellableButton
                    Grid.Column="0"
                    Height="35"
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    ButtonText="{ns:Loc LblLoadImage}"
                    CancelButtonImage="{StaticResource CancelSVG}"
                    CancelCommand="{Binding CancelLoadImageCommand}"
                    Command="{Binding LoadImageCommand}" />
                <ninactrl:LoadingControl
                    Height="30"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    LoadingImageBrush="{StaticResource PrimaryBrush}"
                    Visibility="{Binding LoadImageCommand.Execution.IsNotCompleted, Converter={StaticResource BooleanToVisibilityCollapsedConverter}, FallbackValue=Collapsed}" />
            </UniformGrid>

            <GroupBox Header="{ns:Loc LblCameraParameter}">
                <StackPanel Orientation="Vertical">
                    <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                        <UniformGrid Margin="0,6,0,6" Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblWidth}" />
                            <TextBox Margin="5,0,0,0" Text="{Binding CameraWidth}" />
                        </UniformGrid>
                    </Border>
                    <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                        <UniformGrid Margin="0,6,0,6" Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblHeight}" />
                            <TextBox Margin="5,0,0,0" Text="{Binding CameraHeight}" />
                        </UniformGrid>
                    </Border>
                    <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
                        <UniformGrid Margin="0,6,0,6" Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblPixelSize}" />
                            <TextBox Margin="5,0,0,0" Text="{Binding CameraPixelSize}" />
                        </UniformGrid>
                    </Border>
                    <Border
                        Margin="0,6,0,6"
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="0,0,0,1">
                        <UniformGrid Margin="0,6,0,6" Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblFocalLength}" />
                            <TextBox Margin="5,0,0,0" Text="{Binding FocalLength}" />
                        </UniformGrid>
                    </Border>
                    <Border
                        BorderBrush="{StaticResource BorderBrush}"
                        BorderThickness="0,0,0,1">
                        <UniformGrid Columns="2">
                            <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblRotation}" />
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Margin="5,0,0,0" MinWidth="20"
                                    VerticalAlignment="Center"
                                    Text="{Binding Rectangle.Rotation}" />
                                <Slider
                                    Grid.Column="1"
                                    Margin="5,0,0,0"
                                    IsSnapToTickEnabled="True"
                                    Maximum="360"
                                    Minimum="0"
                                    TickFrequency="5"
                                    Value="{Binding Rectangle.Rotation, FallbackValue=0}" />
                            </Grid>
                        </UniformGrid>
                    </Border>
                </StackPanel>
            </GroupBox>

            <Button
                Height="35"
                Margin="5"
                HorizontalAlignment="Stretch"
                Command="{Binding SetSequenceCoordinatesCommand}">
                <TextBlock
                    Foreground="{StaticResource ButtonForegroundBrush}"
                    Text="{ns:Loc LblSetAsSequenceTarget}"
                    TextWrapping="Wrap" />
            </Button>
        </StackPanel>

        <GridSplitter
            Grid.Column="1"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch" />

        <Grid Grid.Column="2">
            <!--<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">-->
            <Viewbox Stretch="Uniform">
                <Canvas
                    Width="{Binding ActualWidth, ElementName=PART_Image}"
                    Height="{Binding ActualHeight, ElementName=PART_Image}"
                    ClipToBounds="True">
                    <Canvas.Background>
                        <VisualBrush>
                            <VisualBrush.Visual>
                                <Image
                                    x:Name="PART_Image"
                                    Source="{Binding Image, IsAsync=True}"
                                    Stretch="Uniform" />
                            </VisualBrush.Visual>
                        </VisualBrush>
                    </Canvas.Background>
                    <Rectangle
                        Canvas.Left="{Binding Rectangle.X}"
                        Canvas.Top="{Binding Rectangle.Y}"
                        Width="{Binding Rectangle.Width}"
                        Height="{Binding Rectangle.Height}"
                        behaviors:DragCommandBehavior.Drag="True"
                        behaviors:DragCommandBehavior.DragMoveCommand="{Binding DragMoveCommand}"
                        behaviors:DragCommandBehavior.DragStartCommand="{Binding DragStartCommand}"
                        behaviors:DragCommandBehavior.DragStopCommand="{Binding DragStopCommand}"
                        RenderTransformOrigin="0.5,0.5"
                        Stroke="{StaticResource ButtonForegroundBrush}"
                        StrokeThickness="5">
                        <Rectangle.Fill>
                            <SolidColorBrush Opacity=".25" Color="{Binding Path=Color, Source={StaticResource SecondaryBrush}}" />
                        </Rectangle.Fill>
                        <Rectangle.RenderTransform>
                            <RotateTransform Angle="{Binding Rectangle.Rotation}" />
                        </Rectangle.RenderTransform>
                    </Rectangle>

                    <Grid
                        Canvas.Left="{Binding Rectangle.X}"
                        Canvas.Top="{Binding Rectangle.Y}"
                        Width="{Binding Rectangle.Width}"
                        Height="{Binding Rectangle.Height}"
                        Margin="10,10,0,0"
                        IsHitTestVisible="False"
                        RenderTransformOrigin="0.5,0.5">
                        <Viewbox Height="100" Stretch="Uniform">
                            <StackPanel Orientation="Vertical">
                                <!--<StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="{ns:Loc LblDimensions}"  />
                                    <TextBlock Text="{Binding CameraWidth}" />
                                    <TextBlock Text="x" />
                                    <TextBlock Text="{Binding CameraHeight}" />
                                </StackPanel>-->

                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblRA}" />
                                    <TextBlock Margin="5,0,0,0" Text="{Binding SelectedCoordinates.RAString}" />
                                </StackPanel>
                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock VerticalAlignment="Center" Text="{ns:Loc LblDec}" />
                                    <TextBlock Margin="5,0,0,0" Text="{Binding SelectedCoordinates.DecString}" />
                                </StackPanel>
                            </StackPanel>
                        </Viewbox>
                    </Grid>


                </Canvas>
            </Viewbox>
            <!--</ScrollViewer>-->


            <!--<ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                <Canvas
                    Width="1000"
                    Height="1000"
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Stretch">

                    <Image Source="{Binding Image}" Stretch="Uniform" />
                    <Rectangle
                        Canvas.Left="{Binding X}"
                        Canvas.Top="{Binding Y}"
                        Width="{Binding Width}"
                        Height="{Binding Height}"
                        DataContext="{Binding Rectangle}"
                        Stroke="Red"
                        StrokeThickness="5" />
                </Canvas>
            </ScrollViewer>-->
        </Grid>
    </Grid>
</UserControl>
